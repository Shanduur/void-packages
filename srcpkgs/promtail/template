# Template file for 'promtail'
pkgname=promtail
version=2.6.1
revision=1
wrksrc="loki-${version}"
build_style=go
go_import_path="github.com/grafana/loki"
go_package="${go_import_path}/clients/cmd/promtail"
short_desc="Agent to ship the contents of local logs to a Grafana Loki instance"
maintainer="Mateusz Urbanek <murbanek@shanduur.com>"
license="Apache-2.0"
homepage="https://grafana.com/oss/loki/"
distfiles="https://github.com/grafana/loki/archive/v${version}.tar.gz"
checksum=4b41175e552dd198bb9cae213df3c0d9ca8cacd0b673f79d26419cea7cfb2df7
conf_files=/etc/promtail/config.yaml

pre_build() {
	export CGO_ENABLED=0
}

post_install() {
	vmkdir etc/promtail
	vcopy clients/cmd/promtail/promtail-local-config.yaml etc/promtail/config.yaml
	vsv promtail
}
